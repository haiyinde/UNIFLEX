{% extends 'base.html' %}
{% load bootstrap5 %}
{% block content %}
  <div class="container" style="color:white; font-size: 1.25rem; background-color:rgba(0,0,0,0.8)">
    <h1 class="row mt-5 ml-1"> ê²Œì‹œê¸€ </h1>
    <p>ì˜í™” ì œëª© : {{review.movie.title}}</p>
    <p>ì‘ì„±ì : <a href="{% url 'accounts:profile' review.user %}" style="color: white; text-decoration: none;">{{review.user}}</p></a>
    <p>í‰ì  : {{review.rank}}</p>
    <p>ë¦¬ë·° ì œëª© : {{review.title}}</p>
    <p>ë‚´ìš© : {{review.content}}</p>
    <small class="float-right" style="color:grey;">ì‘ì„±ì‹œê°„ : {{review.created_at}}</small><br>
    <small class="float-right" style="color:grey;">ìˆ˜ì •ì‹œê°„ : {{review.updated_at}}</small><br>


    {% comment %} ì¢‹ì•„ìš” ë²„íŠ¼ {% endcomment %}

      <form action="{% url 'community:likes' review.pk %}" method="POST">
        {% csrf_token %}
          {% if user in review.like_users.all %}
            <button class="btn btn-light btn-outline-dark shadow-none float-left"><i class="fas fa-heart" style="color:red; border:none;"></i>ì¢‹ì•„ìš” {{ review.like_users.all|length }}</button>
          {% else %}
            <button class="btn btn-light btn-outline-dark shadow-none float-left"><i class="far fa-heart" style="color:red; border:none;"></i>ì¢‹ì•„ìš” {{ review.like_users.all|length }}</button>
          {% endif %}
      </form>

    {% comment %} ì‘ì„±ìë¼ë©´ update í™”ë©´ ì¶œë ¥{% endcomment %}
    {% if user == review.user %}
      <button class="btn btn-light btn-outline-dark btn-m m-1 float-right"><a href="{% url 'community:update' review.pk %}" style="color: black;"><i class="fas fa-pencil-alt"></i>ìˆ˜ì •</a></button>
      <form action="{% url 'community:delete' review.pk %}" method="POST">
        {% csrf_token %}
        <button type="submit" class="btn btn-light btn-outline-danger btn-m m-1 float-right"><i class="far fa-trash-alt"></i>ì‚­ì œí•˜ê¸°</button>
      </form>
    {% endif %}
    
    
    <br>
    <hr>
    <h4><i class="fas fa-comments"> ëŒ“ê¸€ {{ comments |length }}</i></h4>


    <!-- {% for comment in comments %}
    <p>{{ comment.content }} / ì‘ì„±ì: <a href="{% url 'accounts:profile' comment.user_id %}">{{ comment.user_id }}</a></p>
    {% endfor %} -->

    <ul>
      {% for comment in comments %}
        <li>
          {{ comment.user }} - {{ comment.content }}
          {% if user == comment.user %}
            <a href="{% url 'community:comment_update' review.pk comment.pk%}" style="text-decoration:none; color:white;">[ìˆ˜ì •]</a>
            <form action="{% url 'community:comment_delete' review.pk comment.pk %}" method="POST" class="d-inline">
              {% csrf_token %}
              <input type="submit" value="[ì‚­ì œ]" style="background:none; color:white; border:0;">
            </form>
          {% endif %}
        </li>
      {% empty %}
        <p>ëŒ“ê¸€ì´ ì—†ì–´ìš” ğŸ˜”</p>
      {% endfor %}
    </ul>
    <hr>

    {% comment %} login userë©´ comment form {% endcomment %}
    {% if request.user.is_authenticated %}
      <form action="{% url 'community:comment' review.pk %}" method="POST"> 
        {% csrf_token %}
        {% bootstrap_form comment_form %}
        <button type="submit" class="btn btn-light btn-m float-right m-1"><i class="fas fa-comment-dots"></i>ëŒ“ê¸€ ë‹¬ê¸°</button>
      </form>
    {% else %}
      <button class="btn btn-primary btn-m m-1"><a href="accounts:login">ë¡œê·¸ì¸í•˜ëŸ¬ ê°€ê¸°</a></button>
    {% endif %}
  </div>

  {% comment %} ì»¤ë®¤ë‹ˆí‹°ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ {% endcomment %}
  <button class="btn btn-light btn-outline-dark btn-m m-1 float-left"><a href="{% url 'community:index' %}" style="color: black;"><i class="fas fa-arrow-left"></i> ì»¤ë®¤ë‹ˆí‹°</a></button>


  <style>
      .blur {
      background: rgba(255, 255, 255, 0.2); // Make sure this color has an opacity of less than 1
      backdrop-filter: blur(8px); // This be the blur
      height: 100vh;
      width: 50%;
    }
  </style>
{% endblock content %}